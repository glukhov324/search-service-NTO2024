# НТО 2024: поиск достопримечательностей

Организаторами были предоставлены [данные](https://drive.google.com/drive/folders/1PxJu74vRjOGFydjSgQr_Z7DqmRC1gvX9?usp=sharing) для Екатеринбурга, Нижнего Новгорода, Владимира, Ярославля

Исходные сырые данные были соединены в один датасет и очищены от чёрно-белых изображений и изображений-коллажей при помощи модели clip 

### Какие задачи решает сервис?

1. Нахождение по входящему изображению распределения вероятностей на top-5 категорий достопримечательностей, 
top-k названий наиболее похожих достопримечательностей
2. Нахождение top-5 наиболее соответствующих изображений достопримечательностей на входящий текстовый запрос

Для пункта 1 используется классификатор с двумя головами (одна голова определяет категорию места, другая голова - название места),
для извлечения признаков из изображения была выбрана архитектура MobileNet. Всего:  25 категорий и 387 названий мест

Целевая метрика соревнования: precision@5

Полученная модель имеет precision@5 = 0.76 для названий мест и precision@5 = 0.94 для категорий


Для пункта 2 используется модель ruberttiny2 для извлечения эмбеддингов из названий мест, применяется библиотека faiss 
для ранжирования названий из датасета относительно входящего текстового запроса, для top-5 наиболее подходящих названий из датасета
выдаются изображения, соответствующие этим названиям


python version - 3.10

## Скачивание необходимых файлов [этой](https://drive.google.com/drive/folders/1NWGmIqbgzb2MQ9ad3PBifPaqbAaSR598?usp=sharing) директории гугл диска 

* Скачайте подготовленный [датасет](https://drive.google.com/file/d/1kVz-R1svwvo8Y8PDpvI5UjYNNL8ISBcu/view?usp=sharing) и поместите его в src/dataset_prepare/


## __Запуск сервиса__:

Убедитесь, что вы выполнили предыдущий шаг (Скачивание необходимых файлов)

```sh
docker build -t nto:v1 .
docker run -p 8000:8000 --gpus=all nto:v1
```

документация сервиса будет доступна [здесь](http://0.0.0.0:8000/docs)

## Демо

В demo.ipynb находится демонстрация работы сервиса